SELECT  
  a.id 
  a.kontakt_id_c,
  a.name,
  a.email,
  a.lead_source,
  
  b.id 
  b.status 
  b.is_converted,
  b.produktcode_c 
  
  c.produkt_c 
  c.produkt_id18_c,
  c.kontakt_c 
  
  e.id AS opportunity_id,
  e.stage_name,
  e.amount,
  e.probability,
  e.close_date,
  e.lead_source AS opportunity_lead_source,
  
  d.id AS product_id,
  d.is_active,
  d.is_deleted,
  d.is_archived,
  d.fachbereich_c AS product_fachbereich,
  d.standort_c AS product_standort,
  d.zeitraum_c AS product_zeitraum,
  d.semester_produkt_c,
  d.studium_beginn_datum_c AS product_studium_beginn,
  d.bewerbung_bis_datum_c AS product_bewerbung_bis,
  d.art_der_ausbildung_c AS product_art_der_ausbildung,
  d.titel_abschluss_c AS product_titel_abschluss,
  d.produktcode_c AS product_produktcode,
  d.studiendauer_monate_c AS product_studiendauer_monate,
  d.semesterbeitrag_c AS product_semesterbeitrag,
  d.produktcode_nachfolgeprodukt_c AS product_nachfolgeprodukt

FROM 
  `cognos-bildungsgruppe-ag.dlt_salesforce.contact` as a

LEFT JOIN `cognos-bildungsgruppe-ag.dlt_salesforce.lead` as b
  ON a.id = b.lead

LEFT JOIN `cognos-bildungsgruppe-ag.dlt_salesforce_staging.product_interest` as c
  ON b.id = c.id
LEFT JOIN `cognos-bildungsgruppe-ag.dlt_salesforce_staging.product_2` as d
  ON c.id = d.id
LEFT JOIN `cognos-bildungsgruppe-ag.dlt_salesforce_staging.opportunity` as e
  ON a.id = e.id






